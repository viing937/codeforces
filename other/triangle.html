<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<script>
    function getPar(par){
        var local_url = document.location.href; 
        var get = local_url.indexOf(par+"=");
        if ( get === -1 ){
            return false;   
        }   
        var get_par = local_url.slice(par.length + get + 1);    
        var nextPar = get_par.indexOf("&");
        if(nextPar !== -1){
            get_par = get_par.slice(0, nextPar);
        }
        return get_par;
    }
    function draw(a, b, c){
        var canvas = document.getElementById("canvas");
        var ctx = canvas.getContext("2d");

        var height = canvas.height,
            width = canvas.width;

        var x1 = 0, y1 = 0;
        var x2 = c, y2 = 0;
        var cosA = (b*b+c*c-a*a)/2/b/c;
        var x3 = x1+b*cosA, y3 = Math.sqrt(b*b-x3*x3);

        var minx = Math.min(Math.min(x1, x2), x3),
            maxx = Math.max(Math.max(x1, x2), x3),
            miny = Math.min(Math.min(y1, y2), y3),
            maxy = Math.max(Math.max(y1, y2), y3);
        if ( maxx-minx > width || maxy-miny > height ){
            ctx.fillText("Too Large to draw", width/2-40, height/2);
            return;
        }

        var dx = (width-minx-maxx)/2, dy = (height-miny-maxy)/2;
        x1 = x1+dx, y1 = y1+dy;
        x2 = x2+dx, y2 = y2+dy;
        x3 = x3+dx, y3 = y3+dy;

        ctx.beginPath();
        ctx.moveTo(x1, y1);
        ctx.lineTo(x2, y2);
        ctx.lineTo(x3, y3);
        ctx.closePath();
        ctx.stroke();

        if ( maxx-minx > 20 || maxy-miny > 20 ){
            ctx.fillText("a", (x2+x3)/2-3, (y2+y3)/2);
            ctx.fillText("b", (x1+x3)/2-3, (y1+y3)/2);
            ctx.fillText("c", (x1+x2)/2-3, (y1+y2)/2+3);
        }
    }
    window.onload = function(){
        var a = getPar("a"), b = getPar("b"), c = getPar("c");
        var form = document.getElementById("triangle");
            result = document.getElementById("result");
        form.a.value = a||"", form.b.value = b||"", form.c.value = c||"";
        if ( a || b || c ){
            if ( a === "" || b === "" || c === "" || isNaN(a) || isNaN(b) || isNaN(c) ){
                result.innerHTML = "输入不合法";
                return;
            }
            a = parseFloat(a), b = parseFloat(b), c = parseFloat(c);
            if ( a <= 0 || b <= 0 || c <= 0 ){
                result.innerHTML = "输入不合法";
                return;
            }
            if ( a+b <= c || a+c <= b || b+c <= a ){
                result.innerHTML = "不能构成三角形";
                return;
            }
            var s = (a+b+c)/2;
            var area = Math.sqrt(s*(s-a)*(s-b)*(s-c));
            result.innerHTML = "面积 = " + area.toFixed(2);
            draw(a, b, c);
        }
    }
</script>
<style type="text/css">
    html, body{
        margin: 0px;
        padding: 0px;
        height: 500px;
        width: 100%;
    }
    .leftside{
        background: #E6E6E6;
        float: left;
        height: 100%;
        width: 240px;
    }
    .rightside{
        height: 100%;
    } 
</style>
</head>
<body>
<div class="leftside">
    <div style="text-align: center; margin: 15px 0 0 0">请输入三角形的三边长</div><br/>
    <form id="triangle" method="get">
        <label for="a">a =</label>
        <input type="text" name="a" autocomplete="off" /><br/>
        <label for="b">b =</label>
        <input type="text" name="b" autocomplete="off" /><br/>
        <label for="c">c =</label>
        <input type="text" name="c" autocomplete="off" /><br/>
        <input type="submit" value="计算" style="height: 40px; width: 50%; display: block; margin: auto">
    </form>
    <div id="result" style="text-align: center; margin: 15px 0 0 0">
    </div>
</div>
<div class="rightside">
    <canvas id="canvas" style="height: 100%; border: 1px solid #d3d3d3">
    Your browser does not support the HTML5 canvas tag.</canvas>
</div>
</body>
</html>
